<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="copyright" content="¬© 2025 Pranshu Kumar Chaudhary. All Rights Reserved.">
    <meta name="author" content="Pranshu Kumar Chaudhary">
    <title>Consensus Simulator - Blockchain Activities</title>

    <!-- Design System -->
    <link rel="stylesheet" href="experimental-design.css">
    <link rel="stylesheet" href="ai-fundamentals.css">
    <link rel="stylesheet" href="consensus-game-enhancements.css">

    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R4MBJ1TPQ5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-R4MBJ1TPQ5');
    </script>
</head>

<body>
    <div class="experimental-container">

        <!-- Standard Sidebar -->
        <div class="experimental-sidebar">
            <div class="sidebar-content">
                <div class="experimental-brand">
                    <h1 class="brand-title"><a href="index.html" style="color: inherit; text-decoration: none;">Emerging
                            Tech Hub</a></h1>
                    <p class="brand-subtitle">Interactive Learning Experience</p>
                </div>

                <nav>
                    <div class="experimental-nav-title">Simulator Modules</div>
                    <ul class="experimental-nav">
                        <li class="experimental-nav-item"><a href="#introduction"
                                class="experimental-nav-link">Introduction</a></li>
                        <li class="experimental-nav-item"><a href="#pow" class="experimental-nav-link">Proof of Work</a>
                        </li>
                        <li class="experimental-nav-item"><a href="#pos" class="experimental-nav-link">Proof of
                                Stake</a></li>
                        <li class="experimental-nav-item"><a href="#byzantine" class="experimental-nav-link">Byzantine
                                Faults</a></li>
                        <li class="experimental-nav-item"><a href="#analysis" class="experimental-nav-link">Analysis</a>
                        </li>
                    </ul>
                </nav>

                <div class="experimental-info-box">
                    <div class="info-box-title">Simulation Progress</div>
                    <div class="info-box-content" id="progress-tracker">
                        <div class="progress-item">
                            <span class="progress-step">1. Theory Init</span>
                            <span class="progress-status" id="intro-status"
                                style="color: var(--color-blue-600)">Active</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-step">2. PoW Mining</span>
                            <span class="progress-status" id="pow-status">Offline</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-step">3. PoS Staking</span>
                            <span class="progress-status" id="pos-status">Offline</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-step">4. BFT Network</span>
                            <span class="progress-status" id="byzantine-status">Offline</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-step">5. Analysis</span>
                            <span class="progress-status" id="analysis-status">Offline</span>
                        </div>
                    </div>
                </div>

                <div class="experimental-info-box">
                    <div class="info-box-title">Quick Navigation</div>
                    <div class="info-box-content">
                        <a href="blockchain-activities.html">‚Üê Back to Activities</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="experimental-main">
            <!-- Hero Section -->
            <div class="fundamentals-hero">
                <div class="hero-content">
                    <span class="hero-tag">Blockchain Activities</span>
                    <h1 class="fundamentals-title">Consensus Mechanism Simulator</h1>
                    <p class="fundamentals-subtitle">Master distributed agreement protocols through interactive
                        visualizations.</p>
                </div>
            </div>

            <div class="fundamentals-content">

                <!-- Introduction Section -->
                <section class="content-section" id="introduction">
                    <h2><span class="emoji">üéØ</span> Understanding Consensus</h2>
                    <div class="learning-panel">

                        <div class="concept-introduction">
                            <p><strong>The Challenge:</strong> In a distributed network where participants don't trust
                                each other, how do you get everyone to agree on a single version of the truth?</p>

                            <p>This is the <strong>consensus problem</strong> - one of the hardest challenges in
                                distributed systems. Blockchain networks solve this through carefully designed consensus
                                mechanisms that create incentives for honest behavior.</p>
                        </div>

                        <div class="saas-box mb-6">
                            <div class="saas-body bg-indigo-50 border-l-4 border-indigo-500">
                                <h4 class="text-sm font-bold text-indigo-700 uppercase mb-2">Security Axiom</h4>
                                <p class="text-indigo-900 m-0">We don't need to make people honest. We just need to make
                                    honesty <strong>profitable</strong> and attacks <strong>expensive</strong>.</p>
                            </div>
                        </div>

                        <div class="learning-objectives mb-8">
                            <h3>What You'll Discover</h3>
                            <ul>
                                <li>Why consensus is fundamentally difficult in distributed systems</li>
                                <li>How different mechanisms trade off security, speed, and energy consumption</li>
                                <li>Why economic incentives are crucial for network security</li>
                                <li>When to use different consensus mechanisms for different applications</li>
                            </ul>
                        </div>
                    </div>

                    <div class="interaction-panel">
                        <div class="saas-box">
                            <div class="saas-header">
                                <span class="saas-title">Strategy Selection</span>
                            </div>

                            <div class="saas-body">
                                <h3 class="mt-0 flex items-center gap-2"><span class="emoji">ü§î</span> Think About It
                                </h3>
                                <p><strong>Question:</strong> You have 100 participants in a network. 30 of them are
                                    trying to cheat. How do you ensure the honest majority can still make correct
                                    decisions?</p>

                                <div class="multiple-choice" id="intro-question">
                                    <button class="choice-button" onclick="checkAnswer('intro', 'wrong1')">A) Trust the
                                        participants to be honest</button>
                                    <button class="choice-button" onclick="checkAnswer('intro', 'wrong2')">B) Have a
                                        central authority decide</button>
                                    <button class="choice-button" onclick="checkAnswer('intro', 'correct')">C) Create
                                        economic incentives that make honesty profitable</button>
                                    <button class="choice-button" onclick="checkAnswer('intro', 'wrong3')">D) Remove the
                                        dishonest participants</button>
                                </div>

                                <div class="answer-feedback" id="intro-feedback" style="display: none;"></div>
                            </div>

                            <div style="margin-top: 2rem; text-align: right;">
                                <button class="experimental-btn experimental-btn--primary" id="start-pow"
                                    onclick="unlockSection('pow', 'pow')" disabled>
                                    Continue to Proof of Work Simulation
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- MODULE 2: PROOF OF WORK -->
                <section id="pow" class="content-section locked-section">
                    <h2><span class="emoji">‚ö°</span> Proof of Work (PoW)</h2>

                    <div class="split-layout">
                        <!-- Left: Theory -->
                        <!-- 1. Hashing Puzzle (Split Card) -->
                        <div style="grid-column: 1 / -1; margin-bottom: 2rem;">
                            <!-- Intro Text (Preserved) -->
                            <div class="mb-6" style="max-width: 800px; margin: 0 auto 2rem auto; text-align: center;">
                                <h3>Cryptographic Mining</h3>
                                <p class="text-muted">Proof of Work is like a lottery where tickets cost computing
                                    power. The first to solve the puzzle wins the right to add the next block.</p>
                            </div>

                            <div class="saas-box">
                                <div class="saas-header">
                                    <span class="saas-title">
                                        <svg class="saas-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
                                        </svg>
                                        Interactive Hash Puzzle
                                    </span>
                                </div>
                                <div class="saas-body">
                                    <div class="pow-split-card">
                                        <div class="input-section">
                                            <div class="input-group mb-4">
                                                <label>Network Difficulty</label>
                                                <div class="flex items-center gap-2">
                                                    <input type="range" id="difficulty-slider" min="1" max="5" value="3"
                                                        oninput="updateDifficulty()"
                                                        style="flex-grow:1; accent-color: var(--sim-primary);">
                                                    <span class="font-mono text-sm font-bold text-primary"
                                                        id="difficulty-display">3 Zeros</span>
                                                </div>
                                            </div>
                                            <div class="input-group mb-4">
                                                <label>Data Payload</label>
                                                <input type="text" class="input-field" value="Hello Blockchain" disabled
                                                    style="background:#f1f5f9;">
                                            </div>
                                            <div class="input-group mb-4">
                                                <label>Nonce (The Variable)</label>
                                                <div class="flex gap-2">
                                                    <input type="number" id="user-nonce" class="input-field font-mono"
                                                        value="0" min="0">
                                                    <button class="sim-btn sim-btn-primary"
                                                        onclick="tryHash()">Mine</button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="terminal-display">
                                            <div class="text-xs text-muted mb-2">OUTPUT HASH</div>
                                            <div class="font-bold text-lg break-all" id="demo-hash"
                                                style="line-height:1.2;">WAITING...</div>
                                            <div class="mt-4 text-xs" id="demo-explanation">Target: Start with 3 zeros
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Economics (SaaS Box) -->
                        <div style="grid-column: 1 / -1; margin-bottom: 2rem;">
                            <div class="saas-box">
                                <div class="saas-header">
                                    <span class="saas-title">Economics of Security</span>
                                </div>
                                <div class="saas-body">
                                    <div class="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <p class="text-sm text-muted mb-2">Mining is secure because it's expensive.
                                                Adjust your share:</p>
                                            <input type="range" id="user-hash-rate" min="0.1" max="50" step="0.1"
                                                value="10" oninput="calculateProfitability()"
                                                style="width:100%; accent-color: var(--sim-primary);">
                                            <div class="flex justify-between text-sm mt-1">
                                                <span>Share: <strong id="hash-rate-percent-display">10%</strong></span>
                                                <span>Profit: <strong id="daily-profit"
                                                        class="text-success">$0</strong></span>
                                            </div>
                                        </div>
                                        <div class="text-sm bg-slate-50 p-4 rounded-lg border border-slate-200">
                                            <div class="flex justify-between mb-1">
                                                <span>Daily Cost:</span>
                                                <span class="font-mono text-danger">-$1.4M</span>
                                            </div>
                                            <div class="flex justify-between mb-1">
                                                <span>Block Rewards:</span>
                                                <span class="font-mono text-success">+$1.5M</span>
                                            </div>
                                            <div class="text-xs text-muted mt-2 italic">
                                                *Simplified metrics for demonstration
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Simulation -->
                        <!-- Mining Race (Dashboard) -->
                        <div style="grid-column: 1 / -1;">
                            <div class="saas-box">
                                <div class="saas-header">
                                    <span class="saas-title">
                                        <svg class="saas-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z">
                                            </path>
                                        </svg>
                                        Mining Race Simulation
                                    </span>
                                    <div class="flex gap-2">
                                        <button class="sim-btn sim-btn-primary" id="start-mining"
                                            onclick="startMiningRace()">Start Race</button>
                                        <button class="sim-btn sim-btn-secondary" id="pause-mining"
                                            onclick="pauseMiningRace()" disabled>Pause</button>
                                    </div>
                                </div>
                                <div class="saas-body">
                                    <div id="racing-miner-1" class="miner-row">
                                        <div class="miner-header">
                                            <span class="font-bold">PowerMiner (40 TH/s)</span>
                                            <span class="text-muted"><span id="attempts-1">0</span> Nonces</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="progress-1" class="progress-fill"
                                                style="width: 0%; background: #3b82f6;"></div>
                                        </div>
                                    </div>
                                    <div id="racing-miner-2" class="miner-row">
                                        <div class="miner-header">
                                            <span class="font-bold">SpeedMiner (30 TH/s)</span>
                                            <span class="text-muted"><span id="attempts-2">0</span> Nonces</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="progress-2" class="progress-fill"
                                                style="width: 0%; background: #6366f1;"></div>
                                        </div>
                                    </div>
                                    <div id="racing-miner-3" class="miner-row">
                                        <div class="miner-header">
                                            <span class="font-bold">HomeMiner (20 TH/s)</span>
                                            <span class="text-muted"><span id="attempts-3">0</span> Nonces</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="progress-3" class="progress-fill"
                                                style="width: 0%; background: #14b8a6;"></div>
                                        </div>
                                    </div>
                                    <div id="racing-miner-4" class="miner-row">
                                        <div class="miner-header">
                                            <span class="font-bold text-danger">AttackMiner (10 TH/s)</span>
                                            <span class="text-muted"><span id="attempts-4">0</span> Nonces</span>
                                        </div>
                                        <div class="progress-track">
                                            <div id="progress-4" class="progress-fill"
                                                style="width: 0%; background: #ef4444;"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Blockchain Visualization (New) -->
                                <div style="border-top: 1px solid var(--sim-border); padding: 1.5rem;">
                                    <h4 class="text-sm font-bold text-muted uppercase mb-4">The Blockchain</h4>
                                    <div class="blockchain-scroll" id="blockchain-container">
                                        <!-- Genesis Block -->
                                        <div class="block-card" style="border-style: dashed; background: #f1f5f9;">
                                            <div class="text-xs font-bold text-muted uppercase">Genesis Block</div>
                                            <div class="text-xs text-muted mt-2">Waiting for miners...</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>

            <!-- DEEP DIVE: ATTACKS & SECURITY (Restored Content) -->
            <div class="learning-panel full-width"
                style="margin-top: 2rem; background: white; padding: 2rem; border-radius: 12px; border: 1px solid var(--sim-border);">
                <h3><span class="emoji">üòà</span> Network Attacks & Defenses</h3>
                <p>In our simulation, <strong>AttackMiner</strong> represents a malicious actor. But what exactly are
                    they trying to do?</p>

                <div class="attack-types"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                    <div class="attack-type-card">
                        <h5 class="mt-0 text-danger"><span class="emoji">üîÑ</span> Double Spending</h5>
                        <p class="text-sm text-muted"><strong>Goal:</strong> Spend the same coins twice by secretly
                            mining an alternative chain.</p>
                        <button class="sim-btn sim-btn-danger w-full justify-center"
                            onclick="simulateAttack('double-spend')">Simulate Attack</button>
                    </div>

                    <div class="attack-type-card">
                        <h5 class="mt-0 text-danger"><span class="emoji">üö´</span> Censorship</h5>
                        <p class="text-sm text-muted"><strong>Goal:</strong> Freeze specific victims by refusing to
                            include their valid transactions.</p>
                        <button class="sim-btn sim-btn-danger w-full justify-center"
                            onclick="simulateAttack('censorship')">Simulate Attack</button>
                    </div>

                    <div class="attack-type-card">
                        <h5 class="mt-0 text-danger"><span class="emoji">üí•</span> Selfish Mining</h5>
                        <p class="text-sm text-muted"><strong>Goal:</strong> Gain unfair rewards by strategically
                            withholding blocks.</p>
                        <button class="sim-btn sim-btn-danger w-full justify-center"
                            onclick="simulateAttack('selfish-mining')">Simulate Attack</button>
                    </div>
                </div>

                <div class="attack-results" id="attack-simulation-results"
                    style="display: none; margin-top: 1rem; padding: 1rem; background: #fef2f2; color: #991b1b; border-radius: 6px;">
                    <h5>Attack Simulation Result</h5>
                    <div id="attack-results-content"></div>
                </div>

                <hr style="margin: 2rem 0; border: 0; border-top: 1px solid #e2e8f0;">

                <div class="interactive-challenges"
                    style="margin: 2rem 0; background: #f8fafc; padding: 1.5rem; border-radius: 12px; border: 1px solid var(--sim-border);">
                    <h3><span class="emoji">üß†</span> Test Your Understanding</h3>

                    <div class="challenge-question" style="margin-bottom: 1.5rem;">
                        <h4>Challenge 1: Mining Economics</h4>
                        <p class="small-text">If electricity costs $0.05 per kWh and your mining rig uses 3000W, how
                            much does it cost to run for 24 hours?</p>
                        <div class="challenge-input">
                            <input type="number" id="electricity-answer" placeholder="Enter cost in USD"
                                style="padding: 0.5rem; border: 1px solid #cbd5e1; border-radius: 4px; margin-right: 0.5rem;">
                            <button class="experimental-btn experimental-btn--sm"
                                onclick="checkElectricityAnswer()">Check Answer</button>
                        </div>
                        <div class="answer-feedback" id="electricity-feedback" style="display: none;"></div>
                    </div>

                    <div class="challenge-question" style="margin-bottom: 1.5rem;">
                        <h4>Challenge 2: Hash Rate Impact</h4>
                        <p class="small-text">If the total network hash rate doubles overnight, what happens to block
                            times?</p>
                        <div class="multiple-choice" id="hashrate-question">
                            <button class="choice-button" onclick="checkHashRateAnswer('double')">A) Twice as
                                fast</button>
                            <button class="choice-button" onclick="checkHashRateAnswer('half')">B) Half as fast</button>
                            <button class="choice-button" onclick="checkHashRateAnswer('same')">C) Stays the
                                same</button>
                            <button class="choice-button" onclick="checkHashRateAnswer('random')">D) Random</button>
                        </div>
                        <div class="answer-feedback" id="hashrate-feedback" style="display: none;"></div>
                    </div>

                    <div class="challenge-question">
                        <h4>Challenge 3: Security Analysis</h4>
                        <p class="small-text">A mining pool controls 35% of the network hash rate. Can they perform a
                            51% attack?</p>
                        <div class="multiple-choice" id="security-question">
                            <button class="choice-button" onclick="checkSecurityAnswer('yes-immediately')">A) Yes,
                                immediately</button>
                            <button class="choice-button" onclick="checkSecurityAnswer('no-need-51')">B) No, they need
                                51%</button>
                            <button class="choice-button" onclick="checkSecurityAnswer('maybe-lucky')">C) Maybe, if very
                                lucky</button>
                            <button class="choice-button" onclick="checkSecurityAnswer('depends-others')">D) Depends on
                                others</button>
                        </div>
                        <div class="answer-feedback" id="security-feedback" style="display: none;"></div>
                    </div>
                </div>

                <h3><span class="emoji">üí≠</span> Deep Thinking Questions</h3>
                <div class="question-set">
                    <div class="reflection-question mb-4">
                        <p><strong>1. Environmental Impact vs Security:</strong> Proof of Work consumes enormous amounts
                            of energy. Is this justified by the security it provides? What alternatives exist?</p>
                        <textarea class="input-field"
                            placeholder="Consider both the benefits of absolute security and the environmental costs..."
                            id="pow-reflection-1" style="min-height: 80px;"></textarea>
                    </div>
                    <div class="reflection-question mb-4">
                        <p><strong>2. Centralization Pressure:</strong> Mining tends to centralize in regions with cheap
                            electricity and specialized hardware. How does this affect Bitcoin's decentralization goals?
                        </p>
                        <textarea class="input-field"
                            placeholder="Think about mining pools, geographic concentration, and ASIC development..."
                            id="pow-reflection-2" style="min-height: 80px;"></textarea>
                    </div>
                    <div class="reflection-question mb-4">
                        <p><strong>3. Future Evolution:</strong> As block rewards decrease (Bitcoin halving),
                            transaction fees must support mining. What are the implications for the network's future?
                        </p>
                        <textarea class="input-field"
                            placeholder="Consider fee markets, layer 2 solutions, and long-term sustainability..."
                            id="pow-reflection-3" style="min-height: 80px;"></textarea>
                    </div>
                </div>
                <button class="experimental-btn" onclick="saveReflections('pow')">Save Reflections</button>
            </div>

            <!-- MODULE 3: PROOF OF STAKE -->
            <section id="pos" class="content-section locked-section">
                <h2><span class="emoji">üå±</span> Proof of Stake (PoS)</h2>
                <div class="pos-grid">
                    <!-- Left: Validator Grid -->
                    <div>
                        <div class="saas-box h-full">
                            <div class="saas-header">
                                <span class="saas-title">
                                    <svg class="saas-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    Validator Pool
                                </span>
                                <span
                                    class="text-xs bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full font-bold">Total
                                    Stake: 1,000,000</span>
                            </div>
                            <div class="saas-body">
                                <div class="validator-grid">
                                    <div class="validator-card" id="validator-1">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                                            <span class="font-bold text-sm">Pool A</span>
                                        </div>
                                        <div class="text-xs text-muted">Stake: <span
                                                class="font-mono font-bold text-main">300k</span></div>
                                        <div class="text-xs text-muted">Prob: <span
                                                class="font-mono text-primary">30%</span></div>
                                        <div class="mt-2 text-xs font-bold text-success hidden" id="reward-1">+ Rewards
                                        </div>
                                    </div>
                                    <div class="validator-card" id="validator-2">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                                            <span class="font-bold text-sm">Pool B</span>
                                        </div>
                                        <div class="text-xs text-muted">Stake: <span
                                                class="font-mono font-bold text-main">250k</span></div>
                                        <div class="text-xs text-muted">Prob: <span
                                                class="font-mono text-primary">25%</span></div>
                                        <div class="mt-2 text-xs font-bold text-success hidden" id="reward-2">+ Rewards
                                        </div>
                                    </div>
                                    <div class="validator-card" id="validator-3">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-2 h-2 rounded-full bg-green-500"></div>
                                            <span class="font-bold text-sm">Pool C</span>
                                        </div>
                                        <div class="text-xs text-muted">Stake: <span
                                                class="font-mono font-bold text-main">200k</span></div>
                                        <div class="text-xs text-muted">Prob: <span
                                                class="font-mono text-primary">20%</span></div>
                                        <div class="mt-2 text-xs font-bold text-success hidden" id="reward-3">+ Rewards
                                        </div>
                                    </div>
                                    <div class="validator-card" id="validator-4">
                                        <div class="flex items-center gap-2 mb-2">
                                            <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                            <span class="font-bold text-sm text-danger">Pool D (Rogue)</span>
                                        </div>
                                        <div class="text-xs text-muted">Stake: <span
                                                class="font-mono font-bold text-main">250k</span></div>
                                        <div class="text-xs text-muted">Prob: <span
                                                class="font-mono text-primary">25%</span></div>
                                        <div class="mt-2 text-xs font-bold text-danger hidden" id="slashed-4">SLASHED
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Control Panel & Theory -->
                    <div class="flex flex-col gap-6">
                        <div class="control-panel">
                            <h4 class="font-bold mb-4 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Consensus Console
                            </h4>

                            <p class="text-sm opacity-80 mb-6">Validators are chosen randomly weighted by their stake.
                                Malicious actors risk losing their deposit ("Slashing").</p>

                            <button class="action-btn" onclick="startPosSimulation()">
                                Select Next Validator
                            </button>
                            <button class="action-btn slash-btn" onclick="visualizeSlashing()">
                                Slash Malicious Actor
                            </button>

                            <div class="mt-4 pt-4 border-t border-indigo-800">
                                <div id="pos-result-content" class="text-sm font-mono text-center min-h-[1.5rem]">
                                    Ready to initialize...
                                </div>
                            </div>
                        </div>

                        <!-- Energy Comparison Mini-Card -->
                        <div class="saas-box p-4">
                            <h5 class="text-sm font-bold text-muted uppercase mb-3 text-center">Energy Efficiency</h5>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span>PoW (Mining)</span>
                                        <span class="text-danger">High Energy</span>
                                    </div>
                                    <div class="h-2 bg-slate-100 rounded-full">
                                        <div class="h-full bg-red-500 rounded-full" style="width: 100%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span>PoS (Staking)</span>
                                        <span class="text-success">~99% Less</span>
                                    </div>
                                    <div class="h-2 bg-slate-100 rounded-full">
                                        <div class="h-full bg-green-500 rounded-full" style="width: 1%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Continued Flow -->
                    <button class="sim-btn sim-btn-primary" id="continue-byzantine"
                        onclick="unlockSection('byzantine', 'byzantine')" disabled
                        style="grid-column: 1 / -1; margin: 0 auto;">
                        Initialize BFT Module ‚Üí
                    </button>
                </div>
            </section>

            <!-- MODULE 4: BYZANTINE FAULTS -->
            <section id="byzantine" class="content-section locked-section">
                <h2><span class="emoji">üè∞</span> Byzantine Fault Tolerance</h2>
                <div class="bft-grid">
                    <!-- Left: Network Visualization -->
                    <div class="network-graph-container" id="network-container">
                        <!-- SVG Lines (Background) -->
                        <svg class="absolute inset-0 w-full h-full"
                            style="width:100%; height:100%; pointer-events:none;">
                            <!-- Connections will be drawn here -->
                            <line x1="50%" y1="20%" x2="20%" y2="50%" stroke="#cbd5e1" stroke-width="2" /> <!-- A-B -->
                            <line x1="50%" y1="20%" x2="80%" y2="50%" stroke="#cbd5e1" stroke-width="2" /> <!-- A-C -->
                            <line x1="50%" y1="20%" x2="50%" y2="80%" stroke="#cbd5e1" stroke-width="2"
                                stroke-dasharray="5,5" /> <!-- A-D -->
                            <line x1="20%" y1="50%" x2="50%" y2="80%" stroke="#cbd5e1" stroke-width="2" /> <!-- B-D -->
                            <line x1="80%" y1="50%" x2="50%" y2="80%" stroke="#cbd5e1" stroke-width="2" /> <!-- C-D -->
                            <line x1="20%" y1="50%" x2="80%" y2="50%" stroke="#cbd5e1" stroke-width="2" /> <!-- B-C -->
                        </svg>

                        <!-- Nodes -->
                        <div id="node-a" class="graph-node" style="top: 20%; left: 50%; background: #4f46e5;">CMD</div>
                        <div id="node-b" class="graph-node" style="top: 50%; left: 20%; background: #059669;">Lt.1</div>
                        <div id="node-c" class="graph-node" style="top: 50%; right: 20%; background: #059669;">Lt.2
                        </div>
                        <div id="node-d" class="graph-node"
                            style="top: 80%; left: 50%; background: #ef4444; border: 4px solid #fecaca;">TRT</div>

                        <!-- Status Overlay -->
                        <div id="byzantine-result-overlay"
                            class="absolute inset-0 flex items-center justify-center pointer-events-none"
                            style="display:none; background: rgba(255,255,255,0.8);">
                            <div class="bg-white p-4 rounded-xl shadow-lg border border-green-200 text-center">
                                <div class="text-3xl mb-2">‚úÖ</div>
                                <h4 class="text-success font-bold">Consensus Reached</h4>
                                <p class="text-sm text-muted">Reliable despite 1 traitor.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Logic & Logs -->
                    <div class="flex flex-col gap-4">
                        <!-- Controls -->
                        <div class="saas-box p-4">
                            <button class="sim-btn sim-btn-primary w-full justify-center"
                                onclick="startByzantineRound()">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Broadcast Orders
                            </button>
                            <div class="mt-4 text-xs text-muted text-center">
                                Commander sends order. Traitor sends conflicting info.
                            </div>
                        </div>

                        <!-- Log -->
                        <div class="message-log-box" id="log-content">
                            <div class="log-entry text-muted italic">System Ready. Waiting for Commander...</div>
                        </div>

                        <!-- Theory Snippet -->
                        <div class="text-sm bg-indigo-50 text-indigo-900 p-4 rounded-xl border border-indigo-100">
                            <h5 class="font-bold mb-1 flex items-center gap-2">
                                <span class="emoji">üõ°Ô∏è</span> The 2/3 Rule
                            </h5>
                            <p class="opacity-80">System tolerates <strong>f</strong> faults if total nodes <strong>n ‚â•
                                    3f + 1</strong>.</p>
                            <p class="mt-2 text-xs opacity-60">Here: 4 nodes can tolerate 1 traitor.</p>
                        </div>
                    </div>
                </div>

                <!-- Next Step (Analysis) -->
                <div class="mt-8 text-center">
                    <button class="sim-btn sim-btn-primary" id="continue-analysis"
                        onclick="unlockSection('analysis', 'analysis')" disabled>
                        Proceed to Final Analysis ‚Üí
                    </button>
                </div>
                <button class="experimental-btn experimental-btn--primary" id="continue-analysis"
                    onclick="unlockSection('analysis', 'analysis')" disabled>
                    Final Analysis ‚Üí
                </button>
        </div>
    </div>
    </section>

    <!-- MODULE 5: ANALYSIS -->
    <section id="analysis" class="content-section locked-section">
        <h2><span class="emoji">üéì</span> Final Report: Architect's Choice</h2>

        <div style="text-align: center; max-width: 600px; margin: 0 auto; padding: 2rem 0;">
            <h3>Select Architecture</h3>
            <p>Based on your simulation data, choose the correct consensus mechanism for the following
                scenarios.</p>
        </div>

        <div class="summary-grid"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
            <div class="scenario-card" onclick="selectScenario('currency')">
                <h4 class="mt-0 text-primary">Scenario 1: Global Cash</h4>
                <p class="text-sm text-muted">Requires absolute censorship resistance. Speed is secondary.</p>
            </div>
            <div class="scenario-card" onclick="selectScenario('supply')">
                <h4 class="mt-0 text-primary">Scenario 2: Supply Chain</h4>
                <p class="text-sm text-muted">Corporate participants. High trust, high speed needed.</p>
            </div>
            <div class="scenario-card" onclick="selectScenario('defi')">
                <h4 class="mt-0 text-primary">Scenario 3: DeFi App</h4>
                <p class="text-sm text-muted">High volume trading. Gas fees must be low.</p>
            </div>
        </div>

        <div id="decision-framework" class="decision-box" style="display: none;">
            <div id="framework-content"></div>
        </div>

        <div class="final-selection-area">
            <h4>Final Choice</h4>
            <div class="button-group-center">
                <button class="experimental-btn" onclick="makeChoice('pow')">Proof of Work</button>
                <button class="experimental-btn" onclick="makeChoice('pos')">Proof of Stake</button>
                <button class="experimental-btn" onclick="makeChoice('pbft')">BFT / Hybrid</button>
            </div>
            <div id="choice-feedback"></div>
        </div>

        <div class="learning-summary"
            style="margin-top: 2rem; background: #f8fafc; padding: 1.5rem; border-radius: 12px; border: 1px solid var(--sim-border);">
            <h3><span class="emoji">üìä</span> What You've Learned</h3>
            <div class="summary-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div class="summary-item">
                    <h4 style="margin:0 0 0.5rem 0; color: var(--sim-accent);">Consensus is Hard</h4>
                    <p style="font-size:0.9rem; margin:0;">Achieving agreement in distributed systems with
                        untrusted participants is one of computer science's hardest problems.</p>
                </div>
                <div class="summary-item">
                    <h4 style="margin:0 0 0.5rem 0; color: var(--sim-accent);">Trade-offs Matter</h4>
                    <p style="font-size:0.9rem; margin:0;">Every consensus mechanism involves trade-offs between
                        security, speed, energy consumption, and decentralization.</p>
                </div>
                <div class="summary-item">
                    <h4 style="margin:0 0 0.5rem 0; color: var(--sim-accent);">Economics Drive Security</h4>
                    <p style="font-size:0.9rem; margin:0;">All successful consensus mechanisms rely on economic
                        incentives to encourage honest behavior and punish attacks.</p>
                </div>
                <div class="summary-item">
                    <h4 style="margin:0 0 0.5rem 0; color: var(--sim-accent);">Context Determines Choice</h4>
                    <p style="font-size:0.9rem; margin:0;">The "best" consensus mechanism depends entirely on
                        your specific requirements and constraints.</p>
                </div>
            </div>
        </div>

        <div class="next-steps" style="margin-top: 2rem; text-align: center;">
            <h3><span class="emoji">üöÄ</span> Continue Your Learning Journey</h3>
            <div class="recommendation-cards"
                style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">
                <div class="recommendation-card"
                    style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid var(--sim-border); width: 300px;">
                    <h4 style="margin-top:0;">Crypto Economics Laboratory</h4>
                    <p style="font-size:0.9rem;">Explore how token incentives create sustainable blockchain
                        networks</p>
                    <button class="experimental-btn" onclick="goToActivity('crypto-economics')" disabled>Coming
                        Soon</button>
                </div>
                <div class="recommendation-card"
                    style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid var(--sim-border); width: 300px;">
                    <h4 style="margin-top:0;">Decentralized Governance</h4>
                    <p style="font-size:0.9rem;">See how consensus mechanisms apply to organizational
                        decision-making</p>
                    <button class="experimental-btn" onclick="goToActivity('governance')" disabled>Coming
                        Soon</button>
                </div>
            </div>
        </div>
    </section>
    </div>
    </div>
    </div>

    <!-- Logic Script -->
    <script src="consensus-game-enhancements.js"></script>
</body>

</html>